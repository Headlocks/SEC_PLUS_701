## Chapter 22: Using Data Sources to Support an Investigation

### Log Data
- Systematically recorded information that's generated by hardware, software, and operating systems
  - Captures events, transactions, and other activities within a system or network
  - Serves as a chronological record for troubleshooting, security monitoring, and investigations
  - Required by various regulations (HIPAA, PCI DSS, SOX)

#### Syslog
- Commonly used protocol for centralizing log data

### Firewall Logs
- Help IT monitor the traffic allowed and denied by a firewall
  - Reveal typical traffic patterns and unauthorized access attempts
  - Common elements:
    - Timestamp
    - Action (ALLOW or DENY)
    - Protocol (TCP)
    - Source IP
    - Destination IP
    - Source Port
    - Destination Port
  - Example:
    ```
    2023-09-23 14:32:10 ALLOW TCP 192.168.1.2 8.8.8.8 443 80
    ```

### Application Logs
- Records of services, events, and systems within an application
  - Provide (nearly) end-to-end visibility of activity
  - It's important to parse, partition, and analyze all logs related to security incidents
  - Critical process data logged about the user, application, and system can help responders understand the nature and extent of an attack

### Endpoint Logs
- Give detailed information about activities on individual devices connected to a network
  - Help identify suspicious or unauthorized behaviors:
    - Installation of unauthorized software
    - Attempts to access restricted files
    - Unrecognized application executions
  - Examples:
    ```
    2023-09-23 14:35:00 User "JohnDoe" initiated "New_Outbound_Connection" to IP "203.0.113.42" on Port "8080"
    2023-09-23 14:36:00 User "JohnDoe" executed "Unknown_Application.exe"
    ```

### OS-Specific Security Logs
- Provide information about events and activities on a specific system
  - System processes, driver loading data, errors, warnings, and failures
  - In Windows, logs can be obtained via the Event Viewer and Windows Admin Center
  - On Linux hosts, log files are typically found in the **/var/log** directory
  - Collect system logs regularly and store them in a secure and separate location

### Intrusion Prevention System (IPS) / Intrusion Detection System (IDS) Logs
- An IPS and IDS work together to prevent and detect potentially harmful activities within a network. Their logs can alert you to various attacks such as SQL injections and cross-site scripting
  - Generated by solutions like Snort and Suricata
  - Examples:
    ```
    2023-09-23 13:45:32 ALERT SQL injection detected from 192.168.1.4
    2023-09-23 13:46:10 ALERT Brute-force attempt from 203.0.113.7
    ```

### Network Logs
- Capture data traffic across the network infrastructure
  - Generated by network monitoring tools like Wireshark and SolarWinds
  - Provide insights into bandwidth usage, connection times, and protocol types
  - Examples:
    ```
    2023-09-23 14:20:15 INFO TCP Connection from 192.168.1.2 to 8.8.8.8
    2023-09-23 14:21:00 WARNING Large data transfer to 203.0.113.8
    ```

### Metadata
- Information about data, such as activities performed on personal computers or mobile phones
  - While individual metadata may seem irrelevant, it becomes valuable when combined with other data
  - Categories of metadata:
    - Descriptive
    - Structural
    - Preservation
    - Use
    - Provenance
    - Administrative

### Data Sources
- Tools and methods utilized to gather, analyze, and present information for investigations
  - Sources range from vulnerability scans to dashboards with real-time analytics
  - Understanding data sources is critical for a comprehensive approach to cybersecurity

#### Vulnerability Scans
- Systematically examine networks, systems, or applications to identify and assess security weaknesses
  - Specialized software probes for known vulnerabilities
  - Network scans should include all devices with IP addresses and their software
  - Save results for 24 months+

#### Automated Reports
- Synthesize various security metrics and events
  - Follow regular schedules (daily scanning) and can also be triggered by specific events
  - Generated by Security Information and Event Management (SIEM) systems like Splunk and IBM QRadar
  - Offer insight into potential security threats and anomalies

#### Dashboards
- User interface that organizes information for easier understanding and real-time monitoring of network performance and security
  - Typically uses graphs, charts, and gauges
  - Serves as a centralized display, consolidating data from multiple sources

#### Packet Captures
- Give a detailed view of network activity
  - Analysts use packet captures to:
    - Identify suspicious patterns
    - Detect deviations from normal network behavior
  - Wireshark is commonly used to capture and analyze packets
